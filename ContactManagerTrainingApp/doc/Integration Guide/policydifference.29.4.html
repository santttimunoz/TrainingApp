<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Customizing Differences for New Lines of Business</title>
    <link rel="StyleSheet" href="css/policydifference.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>PolicyCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-forms.html#2708342">Policy-related Integrations</a> : <a class="WebWorks_Breadcrumb_Link" href="policydifference.29.1.html#2708342">Policy Difference Customization</a> : Customizing Differences for New Lines of Business</span></div>
    <hr align="left" />
    <blockquote>
      <h3 class="H1_-_Heading_1"><a name="2708342">Customizing Differences for New Lines of Business</a></h3>
      <div class="B_-_Body"><a name="2718424">If you create a new line of business, you must perform the following tasks to support the difference engine:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2725805">Using some appropriate abbreviation prefix for the line of business (</a><span class="ps_-_parameter_in_code_snippets">LOB</span>), create a new Gosu class called <span class="ps_-_parameter_in_code_snippets">LOB</span><span class="cv_-_computer_voice">DiffHelper</span>. In this file, add all of the methods that help you add and filter difference items. Specifically, create a method in this class called <span class="cv_-_computer_voice">addDiffItems</span> and <span class="cv_-_computer_voice">filterDiffItems</span>. For more information about difference helper classes, see <a href="javascript:WWHClickedPopup('integration', 'policydifference.29.2.html#2707560', '');" title="Policy Difference Overview">“Difference Helper Classes”</a>. This is discussed further below this bullet list.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2727560">In your line of business, create a new method </a><span class="cv_-_computer_voice">createPolicyLineDiffHelper</span> that creates and returns an instance of your new difference helper subclass.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2729695">Create a new difference tree XML file that describes the structure of any new products. Remember that PolicyCenter configures the XML files one for each product, not one for each line of business. Even if a product had no lines of business, you would need a new XML file. In practice, a new line of business is either:</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="2729716">Part of a new product, in which case you add a new XML file </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="2729717">Part of an existing product, in which case you customize an existing XML file</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="2729703">For details on the format of these files, see </a><a href="javascript:WWHClickedPopup('integration', 'policydifference.29.3.html#2720299', '');" title="Difference Tree XML Configuration">“Difference Tree XML Configuration”</a>. Note the part of that topic that discusses how to tell PolicyCenter where to find your new XML file.</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2725968">Because there are several reasons for calculating differences, you can vary your application logic based on the difference reason. The difference reason is a </a><span class="cv_-_computer_voice">DiffReason</span> enumeration passed to the <span class="cv_-_computer_voice">PolicyPeriodDiffPlugin</span> plugin method <span class="cv_-_computer_voice">compareBranches</span>. Choices include <span class="cv_-_computer_voice">TC_INTEGRATION</span>, <span class="cv_-_computer_voice">TC_MULTIVERSIONJOB</span>, <span class="cv_-_computer_voice">TC_PREEMPTION</span>, <span class="cv_-_computer_voice">TC_POLICYREVIEW</span>, <span class="cv_-_computer_voice">TC_COMPAREJOBS</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2725944">You might want to also customize the </a><span class="cv_-_computer_voice">PCBeanMatcher</span> class, depending on what changes you made. See <a href="javascript:WWHClickedPopup('integration', 'policydifference.29.2.html#2730173', '');" title="Policy Difference Overview">“Compare Individual Objects with Matchers”</a> for details.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2725850">In your difference helper class method </a><span class="cv_-_computer_voice">addDiffItems</span>, create and add the <span class="cv_-_computer_voice">DiffItem</span> objects that you want to display in the multi-version difference screen. There are utility methods in the <span class="cv_-_computer_voice">DiffUtils</span> class for comparing, generating, and filtering difference items. Follow the pattern of the built-in lines of business and products for guidance.</div>
      <div class="B_-_Body"><a name="2705628">You may have to manually add entities not automatically recognized from the compare functions in </a><span class="cv_-_computer_voice">DiffUtils</span>, for instance <span class="cv_-_computer_voice">Effective</span> and <span class="cv_-_computer_voice">Expiration</span> date differences between versions. </div>
      <div class="B_-_Body"><a name="2707823">You can create </a><span class="cv_-_computer_voice">DiffItems</span> manually for these objects by creating an instance of one of the following classes that are subclasses of <span class="cv_-_computer_voice">DiffItem</span>. For instance, <span class="cv_-_computer_voice">DiffAdd</span>, <span class="cv_-_computer_voice">DiffRemove</span>, and <span class="cv_-_computer_voice">DiffSlice</span>. For details, see <a href="javascript:WWHClickedPopup('integration', 'policydifference.29.2.html#2760202', '');" title="Policy Difference Overview">“Difference Item Subclasses”</a>.</div>
      <h6 class="HS_-_Head_Sub"><a name="2706429">Filtering Difference Items</a></h6>
      <div class="B_-_Body"><a name="2708060">To support filtering difference items from database-generated difference items, such as those used by the policy change job, perform the following tasks:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="2706430">In your new Gosu class </a><span class="ps_-_parameter_in_code_snippets">LOB</span><span class="cv_-_computer_voice">DiffHelper</span>, create a method that overrides <span class="cv_-_computer_voice">filterDiffItems</span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2705656">In </a><span class="cv_-_computer_voice">filterDiffItems</span>, remove all difference items you do not want to display. Depending on what you are doing, you might be able to use simple logic using blocks. See <a href="javascript:WWHClickedPopup('gosu', 'collections.20.5.html#1488062', '');" title="Enhancement Reference for Collections and Related Types">“Enhancement Reference for Collections and Related Types” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('gosu', 'collections.20.5.html#1488062', '');" title="Enhancement Reference for Collections and Related Types">Gosu Reference Guide</a></span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2705657">Call the </a><span class="cv_-_computer_voice">filterDiffItems</span> method from <span class="cv_-_computer_voice">filterDiffItems</span> in <span class="cv_-_computer_voice">PolicyPeriodDiffPlugin</span>, as shown in the bold line in the example below:</div>
            </td>
          </tr>
        </table>
      </div>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727603">// Filter diffs by LOB if this is not for integration or out of sequence jobs</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727604">    if (reason != DiffReason.TC_INTEGRATION and </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727605">        reason != DiffReason.TC_APPLYCHANGES) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727606">          </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727607">      // Add diffs for PolicyPeriod attributes</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727608">      if (currentPeriod.Renewal == null and reason != null) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727609">        diffItems = addPolicyPeriodDiffItems(currentPeriod, currentPeriod.BasedOn, diffItems)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727610">      }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727611">      </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727612">// Filter diffs by LOB</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727613">      for (line1 in currentPeriod.BasedOn.Lines){</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727614">        var line2 = currentPeriod.Lines.firstWhere( \ p -&gt; p.Subtype.Code == line1.Subtype.Code )</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727615">        if (line2 != null) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727616">          diffHelper = line1.createPolicyLineDiffHelper(reason, line2)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2762492">          if (diffHelper != null) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2762493">            </a><span class="s_-_strong">diffItems = diffHelper.filterDiffItems(diffItems)</span> </PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2762494">          }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727620">        }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727621">      }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727622">      </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727623">// Remove PolicyPeriod attribute diffs if this is a rewrite job</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727624">      if (currentPeriod.Rewrite != null) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727625">        diffItems.removeWhere( \ d -&gt; d.Bean typeis PolicyPeriod )</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727626">      }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2727586">    } </a></PRE>
      <div class="B_-_Body"><a name="2709191">Because there are several reasons for calculating differences, you can vary your application logic based on the difference reason. The difference reason is a </a><span class="cv_-_computer_voice">DiffReason</span> enumeration passed to the <span class="cv_-_computer_voice">PolicyPeriodDiffPlugin</span> plugin method <span class="cv_-_computer_voice">compareBranches</span>. Choices are defined in the <span class="cv_-_computer_voice">DiffReason</span> typelist and include <span class="cv_-_computer_voice">TC_INTEGRATION</span>, <span class="cv_-_computer_voice">TC_MULTIVERSIONJOB</span>, <span class="cv_-_computer_voice">TC_PREEMPTION</span>, <span class="cv_-_computer_voice">TC_POLICYREVIEW</span>, <span class="cv_-_computer_voice">TC_COMPAREJOBS</span>.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>