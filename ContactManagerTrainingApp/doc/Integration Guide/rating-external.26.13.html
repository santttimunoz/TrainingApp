<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Cost Data Object Methods and Constructors to Override</title>
    <link rel="StyleSheet" href="css/rating-external.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>PolicyCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-forms.html#3043510">Policy-related Integrations</a> : <a class="WebWorks_Breadcrumb_Link" href="rating-external.26.01.html#3043510">Rating Integration</a> : <a class="WebWorks_Breadcrumb_Link" href="rating-external.26.08.html#3043510">Implementing Rating for a New Line of Business</a> : Cost Data Object Methods and Constructors to Override</span></div>
    <hr align="left" />
    <blockquote>
      <h4 class="H2B_-_Heading_2_Break"><a name="3043510">Cost Data Object Methods and Constructors to Override</a></h4>
      <div class="B_-_Body"><a name="3043511">To work properly with the built-in PolicyCenter default rating engine, any new subclass of </a><span class="cv_-_computer_voice">CostData</span> must override (implement) certain methods and constructors. The following subtopics describe the methods that you must override.</div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="3037022">Constructors for a Cost Data Subclass</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3038389">Cost data objects have two constructors that you must implement:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3038390">If the rating engine determines a coverage has a premium, it must create an entirely new cost data. This is the most common situation for needing a new cost data object. In this situation, PolicyCenter creates a cost data object with a constructor that takes effective and expiration dates. To support this, all </a><span class="cv_-_computer_voice">CostData</span> subclasses require a constructor that takes the effective and expiration dates and optionally any other subtype-specific data (to set in private variables). The <span class="cv_-_computer_voice">CostData</span> subclass must pass the effective and expiration dates to its superclass constructor. The superclass constructor sets various defaults for cost properties.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3038495">Guidewire strongly recommends that the constructor includes any subtype-specific properties in the constructor rather than setting these properties after instantiation.</a></div>
      <div class="LP_-_List_Para"><a name="3038582">For example, from the personal auto cost data subtype </a><span class="cv_-_computer_voice">PersonalAutoCovCostData</span>:</div>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038583">// constructor that takes the effective and expiration dates. It sets local variables as needed.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038584">construct(effDate : Date, expDate : Date, vehicleIDArg : Key, covIDArg : Key) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038585">    super(effDate, expDate)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038586">    assertKeyType(vehicleIDArg, PersonalVehicle)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038587">    assertKeyType(covIDArg, PersonalAutoCov)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038588">    _vehicleID = vehicleIDArg</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038589">    _covID = covIDArg</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038590">}</a></PRE>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3071619">If rating </a><span class="e_-_emphasis">only from the date of change forward</span>, then the rating engine must create cost data objects that represent existing costs prior to the change in effective time. The following steps occur:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LS2_-_List_Start_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LS2_-_List_Start_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS2_-_List_Start_002c_Level_2_inner"><a name="3071621">The rating engine finds the relevant </a><span class="cv_-_computer_voice">Cost</span> entities immediately prior to the effective date of the change.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2_-_List_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI2_-_List_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2_-_List_Item_002c_Level_2_inner"><a name="3071622">The rating engine uses the cost data constructor that takes an existing cost.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2_-_List_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="LI2_-_List_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2_-_List_Item_002c_Level_2_inner"><a name="3037373">The constructor creates a cost data object that matches the existing cost.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="3037467">To support this, all </a><span class="cv_-_computer_voice">CostData</span> subclasses requires a constructor that takes a <span class="cv_-_computer_voice">Cost</span> of the appropriate type. Contrast this with the other constructor. The other constructor takes the effective and expiration dates for a new initialized cost data but no existing <span class="cv_-_computer_voice">Cost</span> entity.</div>
      <div class="LP_-_List_Para"><a name="3067317">For example, if a rating engine’s </a><span class="cv_-_computer_voice">extractCostDatasFromExistingCosts</span> method creates a <span class="cv_-_computer_voice">CostData</span> subclass, it calls this constructor. This method is only used when rating only from the date of change forward.</div>
      <div class="LP_-_List_Para"><a name="3037514">For example, from the personal auto cost data subtype </a><span class="cv_-_computer_voice">PersonalAutoCovCostData</span>:</div>
      <PRE class="CM_-_Code_Middle_Line"><a name="3037523">// constructor that takes the specific type of Cost entity. It sets local variables as needed.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002254">construct(c : PersonalAutoCovCost) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002255">    super(c)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002256">    _vehicleID = c.PersonalVehicle.FixedId</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002257">    _covID = c.PersonalAutoCov.FixedId </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002246">}</a></PRE>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="3037569">Key Values for Each Cost Data Subclass</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3038312">After the rating engine for each line of business generates cost data objects, the default rating engine merges cost data objects for similar costs. The rating engine considers two cost data objects mergable if they satisfy all of the following:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3043193">They have different but adjacent date ranges. For example, the date range January 1 through March 15 (end of day) and the date range March 16 through September 29.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3043219">They have the same price, in other words the same value in the </a><span class="cv_-_computer_voice">TermAmount</span> property.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3037720">They represent pricing for the same kind of cost for the same thing. For example, for a personal auto coverage cost data object, only merge the cost data objects if the objects share the same coverage ID and vehicle ID. This may require checking multiple properties, and even properties not directly on the object.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3038284">It is insufficient to check merely the fixed ID for the cost or the fixed ID of the target object. Technically, two costs can be equivalent and mergable even if they have different fixed IDs.</a></div>
      <div class="B_-_Body"><a name="3051389">So, each cost data class must help the default rating determine whether two cost data objects are the same costs for the same things. The default rating engine asks the cost data class to provide a list of values that collectively identify which properties to compare for two cost data objects. Generally, that includes matching subtype-specific columns that uniquely identify the set of related costs and the object whose price this represents.</a></div>
      <div class="B_-_Body"><a name="3051236">For example, as described in the bullet list earlier in this topic, suppose there are two personal auto coverage cost data objects. The default rating engine must merge the objects if and only if they have different date ranges and matching vehicle ID and coverage ID. This means that the vehicle ID and coverage ID values are what PolicyCenter calls the </a><span class="e_-_emphasis">key values</span> for the matching algorithm.</div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3051696">Do not confuse </a><span class="e_-_emphasis">key&nbsp;values</span> with <span class="cv_-_computer_voice">Key</span> objects that contain a numeric <span class="e_-_emphasis">fixed ID</span> value and an entity type. The fixed ID <span class="cv_-_computer_voice">Key</span> objects are how cost data objects store a link to a revisioned object within the policy graph. See <a href="javascript:WWHClickedPopup('integration', 'rating-external.26.12.html#3066089', '');" title="Fixed ID Keys Link a Cost Data Object to Another Object">“Fixed ID Keys Link a Cost Data Object to Another Object”</a>.</div>
      <div class="B_-_Body"><a name="3051238">Each cost data class must return a list of its own </a><span class="e_-_emphasis">key values</span> in its <span class="cv_-_computer_voice">KeyValues</span> property getter function. In other words, you must override the <span class="cv_-_computer_voice">property get</span> function for the <span class="cv_-_computer_voice">KeyValues</span> property. To continue the example of the personal auto coverage cost data, that cost data class returns a list that contains the vehicle ID and coverage ID from private variables. In Gosu this looks like the following:</div>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038035">protected override property get KeyValues() : List&lt;Object&gt; {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038036">    return {_vehicleID, _covID}</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3038037">}</a></PRE>
      <div class="B_-_Body"><a name="3037684">Setting this list properly is crucial for the PolicyCenter default rating engine to merge and convert cost data objects properly. Be extremely careful how you implement this method in new cost data classes.</a></div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="3038250">Carefully consider how you implement the </a><span class="cv_-_computer_voice">KeyValues</span> method. Errors in this method corrupt rating data during the merge process. If you have questions about which properties to include in your <span class="cv_-_computer_voice">KeyValues</span> method, contact Guidewire Customer Support.</div>
      <div class="B_-_Body"><a name="3038251">PolicyCenter uses the key values that you return to create an instance of </a><span class="cv_-_computer_voice">CostDataKey</span>. That object encapsulates the key values that the default rating engine uses as it merges cost data objects.</div>
      <h6 class="HS_-_Head_Sub"><a name="3051348">How the Rating Engine Uses the Key Values Property</a></h6>
      <div class="B_-_Body"><a name="3051665">To help in the merge process, PolicyCenter has the concept of the </a><span class="e_-_emphasis">cost&nbsp;key</span> for a given cost. This topic provides some context about how the rating engine uses the key values property in the cost data object.</div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3051710">Do not confuse </a><span class="e_-_emphasis">cost&nbsp;keys</span> with <span class="cv_-_computer_voice">Key</span> objects, which simply contain a numeric <span class="e_-_emphasis">fixed ID</span> value and an entity type. The fixed ID <span class="cv_-_computer_voice">Key</span> objects are how cost data objects store a link to a revisioned object within the policy graph.</div>
      <div class="B_-_Body"><a name="3051351">For </a><span class="cv_-_computer_voice">Cost</span> entity instances, the key has type <span class="cv_-_computer_voice">CostKey</span> and includes:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3051352">The type of the </a><span class="cv_-_computer_voice">Cost</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3051353">The </a><span class="cv_-_computer_voice">ChargePattern</span>, <span class="cv_-_computer_voice">ChargeGroup</span>, and <span class="cv_-_computer_voice">RateAmountType</span> columns</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3051354">Any other columns on the </a><span class="cv_-_computer_voice">Cost</span> that are not defined on the <span class="cv_-_computer_voice">Cost</span> delegate and not a standard policy graph property like <span class="cv_-_computer_voice">cost.EffectiveDate</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3051355">In contrast, for cost data objects, the key has type </a><span class="cv_-_computer_voice">CostDataKey</span> and includes:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3051491">The </a><span class="cv_-_computer_voice">CostData</span> subtype</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3051492">The </a><span class="cv_-_computer_voice">ChargePattern</span>, <span class="cv_-_computer_voice">ChargeGroup</span>, and <span class="cv_-_computer_voice">RateAmountType</span> properties</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3051632">Any values in the </a><span class="cv_-_computer_voice">CostData.KeyValues</span> property for that cost data subclass.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3051633">See earlier in this topic for details writing </a><span class="cv_-_computer_voice">property get</span> function for the <span class="cv_-_computer_voice">KeyValues</span> property in the cost data object subtype.</div>
      <div class="B_-_Body"><a name="3051634">Compare the following statements:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="3071699">Cost</a></span> entity instances are the same kind of cost for the same thing only if the values match for all properties on their <span class="cv_-_computer_voice">CostKey</span> objects.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3051364">Cost data objects are the same kind of cost for the same thing only if the values match for all properties on their </a><span class="cv_-_computer_voice">CostDataKey</span> objects.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="3037061">Copying Custom Properties from Cost Data Objects to Cost Entity Instances</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3038335">After a line of business creates its cost data objects, the default rating engine creates new cost entities or updates existing cost entities.</a></div>
      <div class="B_-_Body"><a name="3038638">The root </a><span class="cv_-_computer_voice">CostData</span> class knows how to copy all the built-in cost properties from the cost data object to the cost object. However, for a cost data subclass, the default rating engine needs help to copy any subclass-specific properties to the corresponding new or changed cost entity.</div>
      <div class="B_-_Body"><a name="3038791">To coordinate this with the default rating engine, each cost data subclass must override (implement) the method </a><span class="cv_-_computer_voice">setSpecificFieldsOnCost</span>. Before doing anything else, this method must call the superclass implementation of this method: <span class="cv_-_computer_voice">super.setSpecifiedFieldsOnCost()</span>. </div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3038809">The </a><span class="e_-_emphasis">cost data base class</span> for each policy line does not need to call the superclass. There is no implementation of this method on the <span class="cv_-_computer_voice">CostData</span> root class. For personal auto, for example, the root class is the class <span class="cv_-_computer_voice">PACostData</span>. However, any subclasses of the cost data base class for each line first must call the superclass implementation.</div>
      <div class="B_-_Body"><a name="3038729">Next, the </a><span class="cv_-_computer_voice">setSpecificFieldsOnCost</span> method must copy any additional properties from the cost data object subclass to the cost entity.</div>
      <div class="B_-_Body"><a name="3038323">For non-foreign-key properties, simply set properties directly on the cost entity instance. Get values from private variables of the cost data object and set properties in the cost entity instance.</a></div>
      <div class="B_-_Body"><a name="3039501">For foreign key properties, this approach does not work. Remember that for cost entities, links to other objects are regular foreign key links directly to the destination entity instance. In contrast, </a><span class="e_-_emphasis">cost data</span> objects store the entity’s fixed ID encapsulated in a <span class="cv_-_computer_voice">Key</span> object. This difference simplifies rating code, particularly with external rating engines. You can easily send entity links as fixed IDs to an external system, and with results from the external system assemble cost data objects from that information. You do not have to worry about as many details of the revisioning system.</div>
      <div class="B_-_Body"><a name="3039188">Because of this difference in links between cost entity objects and cost data objects, your </a><span class="cv_-_computer_voice">setSpecificFieldsOnCost</span> method cannot simply use code such as the following:</div>
      <PRE class="CF_-_Code_First_Line"><a name="3039189">// This does NOT work because the cost data private variables like _line </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3039419">// contain a Key object (which contains a fixed ID), not a real link to a PolicyLine entity</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="3039406">costEntity.PolicyLine = _line </a></PRE>
      <div class="B_-_Body"><a name="3039190">To resolve this difference between how costs and cost data objects handle links, you can use a method called </a><span class="cv_-_computer_voice">setFieldValue</span> on the <span class="cv_-_computer_voice">Cost</span> entity. The <span class="cv_-_computer_voice">setFieldValue</span> method takes two arguments:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3039220">The property name on the </a><span class="cv_-_computer_voice">Cost</span> entity, as a <span class="cv_-_computer_voice">String</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3039238">A </a><span class="cv_-_computer_voice">Key</span> containing the fixed ID for the object to which you want to link. Alternatively, you can optionally pass a fixed ID <span class="cv_-_computer_voice">String</span> directly to this method instead of a <span class="cv_-_computer_voice">Key</span> if you have a plain fixed ID <span class="cv_-_computer_voice">String</span> for some reason. You might notice that some of the built-in rating code passes a fixed ID <span class="cv_-_computer_voice">Key</span> object to <span class="cv_-_computer_voice">setFieldValue</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3039354">For example, the personal auto cost data subtype </a><span class="cv_-_computer_voice">PersonalAutoCovCostData</span> looks like the following:</div>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002347">override function setSpecificFieldsOnCost(line : PersonalAutoLine, cost : PersonalAutoCovCost) : void {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002348">    super.setSpecificFieldsOnCost(line, cost)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002349">    cost.setFieldValue( "PersonalAutoCov", _covID )  </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002350">    cost.setFieldValue( "PersonalVehicle", _vehicleID )</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3002336">  }</a></PRE>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="3037074">Get Versioned Costs That Match This Cost Data Object</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3041608">After you create cost data objects, the default rating engine must find the set of </a><span class="cv_-_computer_voice">Cost</span> entity instances that correspond to each set of cost data objects. In this context, a <span class="e_-_emphasis">set</span> refers to all cost data objects that share the same <span class="e_-_emphasis">cost&nbsp;data&nbsp;object&nbsp;key&nbsp;values</span>. The cost&nbsp;data&nbsp;object key&nbsp;values are a list of values that the <span class="cv_-_computer_voice">property&nbsp;get</span> function for the <span class="cv_-_computer_voice">KeyValues</span> returns. See <a href="javascript:WWHClickedPopup('integration', 'rating-external.26.13.html#3037569', '');" title="Cost Data Object Methods and Constructors to Override">“Key Values for Each Cost Data Subclass”</a>.</div>
      <div class="B_-_Body"><a name="3039588">The rating engine must find the corresponding costs entity instances for two different reasons:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3039635">Find existing premium overrides to apply to a newly-created cost data object </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3039657">Use the cost data objects to update the </a><span class="cv_-_computer_voice">Cost</span> entity instances in the database </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3039669">To find the set of versioned costs, the rating engine asks each cost data object. Every cost data class must override the </a><span class="cv_-_computer_voice">getVersionedCosts</span> method to provide this information. This is the most complicated function that a cost data subclass must implement. It is complicated because it requires careful application of knowledge about the PolicyCenter revisioning system.</div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3039816">Before starting to write this code or reading the rest of this topic, consider reviewing the revisioning documentation. For critical conceptual information about how PolicyCenter stores objects that change across a policy term, see </a><a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#2692659', '');" title="Structure of Revisioning Across Effective Time">“Structure of Revisioning Across Effective Time” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#2692659', '');" title="Structure of Revisioning Across Effective Time">Application Guide</a></span>. For important information about version lists and version list APIs, see <a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#3045892', '');" title="Structure of Revisioning Across Effective Time">“Version List API Reference” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#3045892', '');" title="Structure of Revisioning Across Effective Time">Application Guide</a></span>.</div>
      <div class="B_-_Body"><a name="3039897">The cost data object’s </a><span class="cv_-_computer_voice">getVersionedCosts</span> method must return a list of version lists for the appropriate cost object type. A <span class="cv_-_computer_voice">VersionList</span> represents a set of cost rows that represent the cost for the same thing. Each row represents a different date range, and the price for that date range.</div>
      <div class="B_-_Body"><a name="3039929">For example, for a </a><span class="cv_-_computer_voice">PersonalAutoCovCostData</span> object, the <span class="cv_-_computer_voice">getVersionedCosts</span> method returns a list of version lists that represent <span class="cv_-_computer_voice">PersonalAutoCovCost</span> entity instances.</div>
      <div class="B_-_Body"><a name="3040712">The calling code expects to receive a </a><span class="cv_-_computer_voice">List</span> containing only 1 version list, or an empty list if no existing cost entities match this cost data object.</div>
      <div class="B_-_Body"><a name="3040713">A general approach for the </a><span class="cv_-_computer_voice">getVersionedCosts</span> method is to first get a reference to the version list for the relevant object that has a cost. Use the <span class="cv_-_computer_voice">PolicyLine</span> method argument (which identifies the branch) and any private variables from your cost data object that contain <span class="cv_-_computer_voice">Key</span> objects. </div>
      <div class="B_-_Body"><a name="3040672">Remember that a cost data object does not directly link to persisted entity instances. In the place of a direct link, the cost data object instead stores a fixed ID </a><span class="cv_-_computer_voice">Key</span> object. The fixed ID <span class="cv_-_computer_voice">Key</span> object encapsulates the entity type and the numeric <span class="e_-_emphasis">fixed&nbsp;ID</span> for the target object. The fixed ID uniquely represents the object within that branch (and across branches), across all of effective time. See <a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#2692659', '');" title="Structure of Revisioning Across Effective Time">“Structure of Revisioning Across Effective Time” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#2692659', '');" title="Structure of Revisioning Across Effective Time">Application Guide</a></span> and <a href="javascript:WWHClickedPopup('integration', 'rating-external.26.12.html#3066089', '');" title="Fixed ID Keys Link a Cost Data Object to Another Object">“Fixed ID Keys Link a Cost Data Object to Another Object”</a>.</div>
      <div class="B_-_Body"><a name="3040673">Cost data objects store these fixed ID </a><span class="cv_-_computer_voice">Key</span> objects in private variables to refer to other entities. For example, a <span class="cv_-_computer_voice">PersonalAutoCovCostData</span> object links to a <span class="e_-_emphasis">coverage</span> with a fixed ID <span class="cv_-_computer_voice">Key</span> object for the coverage using its private variable called <span class="cv_-_computer_voice">_covID</span>. </div>
      <div class="B_-_Body"><a name="3041164">To create a version list from a fixed ID </a><span class="cv_-_computer_voice">Key</span> object, use the <span class="cv_-_computer_voice">EffDatedUtil</span> static method <span class="cv_-_computer_voice">createVersionList</span>. Its method signature is:</div>
      <div class="CS_-_Code_Single_Line"><a name="3041320">EffDatedUtil.createVersionList( branch : PolicyPeriod, fixedIDKey : Key) </a></div>
      <div class="B_-_Body"><a name="3041312">The first argument is the root </a><span class="cv_-_computer_voice">PolicyPeriod</span> for that branch. You can easily get that from the <span class="cv_-_computer_voice">getVersionedCosts</span> first parameter of type <span class="cv_-_computer_voice">PolicyLine</span>. Simply get the <span class="cv_-_computer_voice">PolicyLine.Branch</span> property. The <span class="cv_-_computer_voice">getVersionedCosts</span> second parameter is the fixed ID <span class="cv_-_computer_voice">Key</span> that identifies the desired object with a cost. Get this information from a private variable in your cost data object. For example, the <span class="cv_-_computer_voice">PersonalAutoCovCostData</span>.<span class="cv_-_computer_voice">_covID</span> property.</div>
      <div class="B_-_Body"><a name="3041202">The </a><span class="cv_-_computer_voice">createVersionList</span> method returns that object’s <span class="e_-_emphasis">version list</span>, which is an object that can provide information about a revisioned entity and how it changes across time. The compile-time type of this version list is an untyped version list (typed to the version list superclass). Cast it as appropriate to the more specific type to access type-specific properties on it.</div>
      <div class="B_-_Body"><a name="3041372">For a real world example, a </a><span class="cv_-_computer_voice">PersonalVehicleCovCostData</span> gets the coverage version list as follows:</div>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041238">&nbsp;&nbsp;// get the version list for the auto coverage</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041893">&nbsp;&nbsp;&nbsp;&nbsp;var covVL = EffDatedUtil.createVersionList( line.Branch, _covID ) as PersonalVehicleCovVersionList</a></PRE>
      <div class="B_-_Body"><a name="3041894">For the common simple case, the target object directly contains costs for only one thing and stores it the </a><span class="cv_-_computer_voice">Costs</span> property. In this simple case, the version list for this object also contains a <span class="cv_-_computer_voice">Costs</span> property. It is important to note that this version list property does not contain costs directly. Instead, it returns a list containing one version&nbsp;list that represents one or more database rows of <span class="cv_-_computer_voice">Cost</span> entities in the branch that represent that same thing. Your <span class="cv_-_computer_voice">getVersionedCosts</span> method can return this list containing a single version list.</div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3041910">The </a><span class="cv_-_computer_voice">Costs</span> property on the version list is an example of a generated property. Gosu dynamically adds it to the <span class="cv_-_computer_voice">PersonalVehicleCovVersionList</span> object because it is a property on a <span class="cv_-_computer_voice">PersonalVehicleCov</span> entity and contains an array of entities. For more about version list generated properties, see <a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#3027931', '');" title="Structure of Revisioning Across Effective Time">“Window Mode API Overview” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#3027931', '');" title="Structure of Revisioning Across Effective Time">Application Guide</a></span>.</div>
      <div class="B_-_Body"><a name="3040849">If no such cost object exists, the version list </a><span class="cv_-_computer_voice">Costs</span> property instead contains an empty list. In other words, it is a list containing zero version lists. Return that value to tell the rating engine that no such cost objects yet exist.</div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3040865">It is unsupported to return more than one version list in the list that you return from </a><span class="cv_-_computer_voice">getVersionedCosts</span>. In real world conditions, each cost data object corresponds to no more than one fixed&nbsp;ID, so no more than one version list is supported. The code that calls the <span class="cv_-_computer_voice">getVersionedCosts</span> method throws an exception if it gets more than one version list.</div>
      <div class="B_-_Body"><a name="3041018">For example, the personal vehicle coverage cost data class (</a><span class="cv_-_computer_voice">PersonalVehicleCovCostData</span>) creates a version list and simply gets the version list property called <span class="cv_-_computer_voice">Costs</span>:</div>
      <PRE class="CF_-_Code_First_Line"><a name="3041019">override function getVersionedCosts(line : PersonalAutoLine) : </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041020">&nbsp;&nbsp;List&lt;com.guidewire.commons.entity.effdate.EffDatedVersionList&gt; {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041021">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041022">&nbsp;&nbsp;// get the version list for the auto coverage</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041023">&nbsp;&nbsp;&nbsp;&nbsp;var covVL = EffDatedUtil.createVersionList( line.Branch, _covID ) as PersonalVehicleCovVersionList</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041024">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041043">&nbsp;&nbsp;// get versionlist.Costs. It contains a list of 1 version list for costs, or is an empty list</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041050">&nbsp;&nbsp;return covVL.Costs</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041025">} </a></PRE>
      <div class="B_-_Body"><a name="3041120">However, some cases are more complex. In some cases the target object may have a </a><span class="cv_-_computer_voice">Costs</span> property but it represents multiple types of costs. For example, a personal auto coverage may support multiple vehicles. In such a case, there is a separate cost for each vehicle. This means that this method must iterate across all costs for the target object and determine which cost entity instances correspond to the current cost data object.</div>
      <div class="B_-_Body"><a name="3040878">For example, for the personal vehicle coverage cost data class (</a><span class="cv_-_computer_voice">PersonalVehicleCovCostData</span>), some costs represent taxes, fees, or costs for vehicles <span class="e_-_emphasis">other</span> than the one we want. To find the right cost, use the <span class="cv_-_computer_voice">where</span> collection enhancement method and to determine if the cost matches the current cost data object. </div>
      <div class="B_-_Body"><a name="3041996">In the personal vehicle coverage example, the Gosu block that tests each item must match a cost object if and only if all of the following are true:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3041981">The cost is associated with the coverage for the cost data. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3041982">The coverage’s cost object has the right type (</a><span class="cv_-_computer_voice">PersonalAutoCovCost</span>). </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3068587">The coverage’s cost object is for a vehicle whose fixed ID </a><span class="cv_-_computer_voice">Key</span> matches the vehicle ID stored in the cost data object. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3068588">This example uses a separate helper method called </a><span class="cv_-_computer_voice">isCostVersionListForVehicle</span>, which determines if the cost is for the same vehicle. Note that this helper method is actually comparing a <span class="e_-_emphasis">version&nbsp;list for the cost</span> not the cost entity itself. For important conceptual information about version lists, see <a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#2692659', '');" title="Structure of Revisioning Across Effective Time">“Structure of Revisioning Across Effective Time” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('app', 'policyrevisions.52.03.html#2692659', '');" title="Structure of Revisioning Across Effective Time">Application Guide</a></span>.</div>
      <div class="B_-_Body"><a name="3068549">The code for this method looks like the following:</a></div>
      <PRE class="CF_-_Code_First_Line"><a name="3041086">override function getVersionedCosts(line : PersonalAutoLine) :</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3058768">&nbsp;&nbsp;List&lt;com.guidewire.commons.entity.effdate.EffDatedVersionList&gt; {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041087">    var covVL = EffDatedUtil.createVersionList( line.Branch, _covID ) as PersonalAutoCovVersionList</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041088">    return covVL.Costs.where(\ costVL -&gt; isCostVersionListForVehicle(costVL)).toList()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041089">  }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041090"> </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041091">[...]</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041092"> </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3041093">  private function isCostVersionListForVehicle(costVL : entity.windowed.PersonalAutoCovCostVersionList)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3058858">&nbsp;&nbsp;&nbsp;: boolean {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3042110">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3042111">&nbsp;&nbsp;&nbsp;&nbsp;//among all rows in the database for this cost, choose the one with the earliest effective date</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3042116">&nbsp;&nbsp;&nbsp;&nbsp;var firstVersion = costVL.AllVersions.first()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3042117">    return firstVersion typeis PersonalAutoCovCost and firstVersion.Vehicle.FixedId == _vehicleID</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="3042118">}</a></PRE>
      <div class="B_-_Body"><a name="3042132">In this example, it chooses the coverage version with earliest effective date. This might seem arbitrary, and in some sense it is. However, cost cannot represents more than one car and a car cannot change its fixed ID value over time. Thus, you can get any coverage version from the version list and dereference its vehicle and get the fixed ID from that.</a></div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="3037090">Specifying Whether to Merge a Cost as Basis Scalable</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3045057">Each cost data subclass indicates whether to merge the </a><span class="cv_-_computer_voice">CostData</span> object as <span class="e_-_emphasis">basis scalable</span>. </div>
      <div class="B_-_Body"><a name="3045359">To specify how to merge the costs, each cost data can implement a property getter function for the property </a><span class="cv_-_computer_voice">MergeAsBasisScalable</span>. In most cases, this property returns always <span class="cv_-_computer_voice">true</span> or always <span class="cv_-_computer_voice">false</span> for any class, but you can add custom logic if necessary to return <span class="cv_-_computer_voice">true</span> or <span class="cv_-_computer_voice">false</span> accordingly.</div>
      <div class="B_-_Body"><a name="3045212">The rating engine behaves differently based on the value of the cost data property </a><span class="cv_-_computer_voice">MergeAsBasisScalable</span>:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3045242">If </a><span class="cv_-_computer_voice">false</span>, the rating engine merges this <span class="cv_-_computer_voice">CostData</span> object using the standard method <span class="cv_-_computer_voice">mergeIfCostEqual</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3045378">If </a><span class="cv_-_computer_voice">true</span>, the rating engine instead merges this <span class="cv_-_computer_voice">CostData</span> object using the method <span class="cv_-_computer_voice">mergeAsBasisScalableIfCostEqual</span>. This method extends this cost data object to cover the period spanned by the other cost. Additionally, it adds together the <span class="cv_-_computer_voice">Basis</span>, <span class="cv_-_computer_voice">ActualTermAmount</span>, and <span class="cv_-_computer_voice">ActualAmount</span> properties if all the following things are true:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="3058926">The passed-in </a><span class="cv_-_computer_voice">CostData</span> is effective as of the expiration date of this current cost. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="3058939">The other cost is equal to this current cost, as determined by the </a><span class="cv_-_computer_voice">isBasisScalableCostEqual</span> method. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3045465">The rating engine also uses the value of </a><span class="cv_-_computer_voice">MergeAsBasisScalable</span> to treat costs differently when creating <span class="cv_-_computer_voice">CostData</span> objects based on a set of existing costs and then prorating them.</div>
      <div class="B_-_Body"><a name="3045288">The root class </a><span class="cv_-_computer_voice">CostData</span> always returns <span class="cv_-_computer_voice">false</span>. Cost data classes can override it as needed, for example:</div>
      <PRE class="CF_-_Code_First_Line"><a name="3045062">override property get MergeAsBasisScalable() : boolean {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3045063">&nbsp;&nbsp;return true</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="3045064">}</a></PRE>
      <div class="B_-_Body"><a name="3045321">An example of when you might use more complex logic in this property get function is general liability exposure costs. The built-in cost data subclasses returns </a><span class="cv_-_computer_voice">true</span> for costs with class codes that have an auditable basis, and <span class="cv_-_computer_voice">false</span> for any other class codes.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>